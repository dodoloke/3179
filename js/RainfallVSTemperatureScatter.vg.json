{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": "container",
  "height": 600,
  "data": {
    "url": "https://raw.githubusercontent.com/dodoloke/3179/refs/heads/main/data/weatherAUS.csv"
  },
  "params": [
    {
      "name": "Year_selection",
      "bind": {
        "input": "select",
        "name": "Year: ",
        "options": [null, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017],
        "labels": ["All Years",  "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017"]
      }
    }
  ],
  "transform": [
    {"filter": "isValid(toNumber(datum.MaxTemp)) && isValid(toNumber(datum.Rainfall))"},
    {"filter": "Year_selection == null || year(toDate(datum.Date)) == Year_selection"}
  ],
  "layer": [
    {
      "mark": {"type": "rect", "opacity": 0.01},
      "encoding": {
        "x": {"datum": 15},
        "x2": {"datum": 30},
        "color": {"value": "grey"}
      }
    },
    {
    "mark": { "type": "circle", "opacity": 0.4, "size": 45},
    "encoding": {
        "x": {
            "field": "MaxTemp",
            "type": "quantitative",
            "title": "Daily Max Temperature (°C)"
        },
        "y": {
            "field": "Rainfall",
            "type": "quantitative",
            "title": "Daily Rainfall (mm)"
        },
        "tooltip" : [
            { "field": "Date", "type": "temporal" },
            { "field": "Location", "type": "nominal" },
            { "field": "MaxTemp", "type": "quantitative", "title": "Max Temp (°C)" },
            { "field": "Rainfall", "type": "quantitative", "title": "Rainfall (mm)" }
         ],
         "color": {"value": "#cf3313"}
      }
    },
    {
      "data": { "values": [{}] },
      "mark": { "type": "rule", "strokeDash": [4,4], "strokeWidth": 2 },
      "encoding": { "y": { "datum": 50 }, "color": { "value": "black" } }   
    },
    {
      "data": { "values": [{}] },
      "mark": { "type": "text", "dx": 6, "dy": -6, "fontWeight": "bold" },
      "encoding": {
        "x": { "datum": 2 },
        "y": { "datum": 53 },
        "text": { "value": "50 mm: Heavy Rain Threshold" },
        "color": { "value": "black" }
      }
    }
  ]
}